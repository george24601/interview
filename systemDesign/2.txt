Design a unix cron job-like utility

How it is implemented in unix system.

On startup, look for .crontab file in the home folder of all account holders

For each crontab file found, determin the next time in the future each command should run

place those commands in F-M event list with next time to run and "five field" time specifier

In the main loop
        look at the head of queue, and sleep for that period of time
        sleep for tht period of time
        after verifying the correct time, execute the task at the head of the queue (in background) with the privileges of the user who created it
Determine the next time in the future to run this command and place it back on the event list at that time value.


Variations:
1. what if we want to keep track of status, and ensure only one instance is running

2. what if the whole thing is distributed and you want HA?

#######

Consider we have mail client that updates the blocked website list for our service. Design one such service so that we can distribute the black list.
the server list is updated once per second
the client pulls our service once every 30 mins

Design:
Obviously, we need to optimize for read performance

so the client has been updated 1800 times between each pull

The client should send a request fetchUpdate(clientVersion), which should return the deltas since the client version

On the reader side, we should have a list of deltas and with each version, and return list of versions. In a k-v store that supports range scan, this should be highly efficient => because they are aligned together in persistant layer

To future improve performance for long missed read, we can have a compacted view every certain versions,
if the new request < last compacted version, just return the whole thing. we should do a log compaction from time to time to purge too old deltas.

In terms of global updates, we will designate 1 DC as master, and other as slaves, and we use cross region ZK to locate which one is alive and forward all write traffic to it. when the master recovered, we will just talk to the new master and sync from the single source of truth to recover
